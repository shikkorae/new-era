<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>voice</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #050505 100%);
            color: #e0e0e0;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .captcha-container {
            background: #121212;
            border: 1px solid #222222;
            border-radius: 16px;
            padding: 30px;
            max-width: 600px;
            width: 100%;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.8);
            text-align: center;
            position: relative;
        }
        
        /* –í–ò–¢–ñ–ï–¢ –£–°–ü–ï–•–ê */
        .success-widget {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            border: 3px solid #00b894;
            border-radius: 20px;
            padding: 30px;
            width: 90%;
            max-width: 550px; /* –£–≤–µ–ª–∏—á–∏–ª –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —à–∏—Ä–∏–Ω—É */
            z-index: 1000;
            box-shadow: 0 0 50px rgba(0, 184, 148, 0.5);
            backdrop-filter: blur(10px);
            animation: widgetAppear 0.5s ease;
        }
        
        .success-widget.active {
            display: block;
        }
        
        @keyframes widgetAppear {
            from {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }
        
        .widget-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 999;
            backdrop-filter: blur(5px);
        }
        
        .widget-overlay.active {
            display: block;
        }
        
        .widget-header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .widget-title {
            font-size: 2rem;
            color: #00b894;
            margin-bottom: 10px;
            text-shadow: 0 0 15px rgba(0, 184, 148, 0.5);
        }
        
        .widget-subtitle {
            color: #a0a0a0;
            font-size: 1.1rem;
        }
        
        /* –û–ë–ù–û–í–õ–ï–ù–ù–´–ô –ö–û–ù–¢–ï–ô–ù–ï–† –î–õ–Ø –ì–ò–§–ö–ò - –î–õ–Ø 518x518 */
        .gif-container {
            width: 100%;
            height: 350px; /* –£–≤–µ–ª–∏—á–∏–ª –≤—ã—Å–æ—Ç—É –¥–ª—è –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–π –≥–∏—Ñ–∫–∏ 518x518 */
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
            border: 2px solid #00b894;
            box-shadow: 0 10px 30px rgba(0, 184, 148, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.3);
        }
        
        .success-gif {
    width: 100%;
    height: 100%;
    object-fit: fill; /* –†–∞—Å—Ç—è–≥–∏–≤–∞–µ—Ç –Ω–∞ –≤–µ—Å—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
}
        
        .music-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            padding: 15px;
            background: rgba(0, 184, 148, 0.1);
            border-radius: 10px;
            border: 2px solid rgba(0, 184, 148, 0.3);
        }
        
        .music-btn {
            background: #00b894;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            transition: all 0.3s ease;
        }
        
        .music-btn:hover {
            background: #00a085;
            transform: scale(1.1);
        }
        
        .music-info {
            text-align: center;
        }
        
        .music-title {
            color: #00b894;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .music-status {
            color: #a0a0a0;
            font-size: 0.9rem;
        }
        
        .widget-footer {
            text-align: center;
            margin-top: 20px;
        }
        
        .continue-btn {
            background: linear-gradient(135deg, #8a2be2, #5a189a);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 0 auto;
        }
        
        .continue-btn:hover {
            background: linear-gradient(135deg, #9d4edd, #7b2cbf);
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(138, 43, 226, 0.4);
        }
        
        /* –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –∫–∞–∫ –±—ã–ª–∏ */
        .header {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #222222;
        }
        
        .step-indicator {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .step {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #333;
        }
        
        .step.completed {
            background: #00b894;
        }
        
        .step.active {
            background: #8a2be2;
        }
        
        h1 {
            color: #8a2be2;
            margin-bottom: 10px;
            font-size: 1.8rem;
        }
        
        .instructions {
            margin-bottom: 30px;
            line-height: 1.6;
            color: #a0a0a0;
        }
        
        .phrase-container {
            background: rgba(138, 43, 226, 0.1);
            border: 2px solid #8a2be2;
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
            text-align: center;
        }
        
        .phrase {
            font-size: 2.2rem;
            font-weight: bold;
            color: #8a2be2;
            margin: 15px 0;
            line-height: 1.3;
            text-shadow: 0 0 15px rgba(138, 43, 226, 0.5);
            font-family: 'Georgia', serif;
            padding: 15px;
            border-radius: 10px;
            background: rgba(138, 43, 226, 0.05);
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 25px 0;
            flex-wrap: wrap;
        }
        
        .control-btn {
            padding: 14px 28px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            min-width: 170px;
            justify-content: center;
        }
        
        .control-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .record-btn {
            background: linear-gradient(135deg, #8a2be2, #5a189a);
            color: white;
        }
        
        .record-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(138, 43, 226, 0.5);
        }
        
        .record-btn.recording {
            background: linear-gradient(135deg, #e17055, #d63031);
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(225, 112, 85, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(225, 112, 85, 0); }
            100% { box-shadow: 0 0 0 0 rgba(225, 112, 85, 0); }
        }
        
        .skip-btn {
            background: linear-gradient(135deg, #6c757d, #495057);
            color: white;
            border: 2px solid #6c757d;
        }
        
        .skip-btn:hover:not(:disabled) {
            background: linear-gradient(135deg, #5a6268, #343a40);
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(108, 117, 125, 0.5);
        }
        
        .skip-btn:disabled {
            background: #333;
            color: #666;
            border-color: #444;
        }
        
        .stop-btn {
            background: linear-gradient(135deg, #333, #222);
            color: white;
            border: 1px solid #444;
        }
        
        .recording-status {
            display: none;
            align-items: center;
            gap: 12px;
            padding: 15px 25px;
            background: linear-gradient(135deg, #e17055, #d63031);
            border-radius: 12px;
            font-weight: 600;
            color: white;
            margin: 20px auto;
            max-width: 300px;
            justify-content: center;
        }
        
        .recording-status.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }
        
        .pulse-dot {
            width: 12px;
            height: 12px;
            background: white;
            border-radius: 50%;
            animation: dotPulse 1s infinite;
        }
        
        @keyframes dotPulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.5); opacity: 0.7; }
        }
        
        .result-container {
            background: rgba(30, 30, 30, 0.8);
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
            display: none;
            animation: slideIn 0.5s ease;
        }
        
        .result-container.show {
            display: block;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .result-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .result-icon {
            font-size: 36px;
        }
        
        .result-text {
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .success {
            color: #00b894;
        }
        
        .error {
            color: #fdcb6e;
        }
        
        .recognized-text {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            font-size: 1.3rem;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            word-break: break-word;
            border: 2px solid #333;
        }
        
        .progress-container {
            margin: 25px 0;
        }
        
        .progress-bar {
            height: 12px;
            background: #333;
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 15px;
            border: 1px solid #444;
        }
        
        .progress-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #e17055, #fdcb6e, #00b894);
            border-radius: 6px;
            transition: width 1s ease;
        }
        
        .progress-labels {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 10px;
        }
        
        .progress-label {
            font-size: 0.9rem;
            color: #a0a0a0;
        }
        
        .progress-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #8a2be2;
            font-family: monospace;
        }
        
        .browser-warning {
            color: #fdcb6e;
            background: rgba(253, 203, 110, 0.1);
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            font-size: 0.95rem;
            border: 2px solid rgba(253, 203, 110, 0.3);
            display: none;
            line-height: 1.5;
        }
        
        .browser-warning.show {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .phrase-hint {
            color: #fdcb6e;
            font-size: 0.9rem;
            margin-top: 10px;
            font-style: italic;
        }
        
        .success-animation {
            animation: successPulse 2s infinite;
        }
        
        @keyframes successPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .waiting-message {
            color: #8a2be2;
            margin: 20px 0;
            font-size: 1.1rem;
            padding: 15px;
            background: rgba(138, 43, 226, 0.1);
            border-radius: 10px;
            border: 2px solid rgba(138, 43, 226, 0.3);
        }
        
        .target-range {
            background: rgba(0, 184, 148, 0.1);
            border: 2px solid rgba(0, 184, 148, 0.3);
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
        }
        
        .target-title {
            color: #00b894;
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }
        
        .target-description {
            color: #a0a0a0;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .target-zone {
            display: inline-block;
            padding: 5px 15px;
            background: linear-gradient(135deg, #00b894, #8a2be2);
            color: white;
            border-radius: 20px;
            font-weight: bold;
            margin: 5px;
            font-size: 1.1rem;
        }
        
        .high-accuracy {
            color: #00cec9;
        }
        
        .high-accuracy-animation {
            animation: highAccuracyPulse 2s infinite;
        }
        
        @keyframes highAccuracyPulse {
            0%, 100% { 
                transform: scale(1); 
                box-shadow: 0 0 20px rgba(0, 206, 201, 0.3);
            }
            50% { 
                transform: scale(1.03); 
                box-shadow: 0 0 30px rgba(0, 206, 201, 0.5);
            }
        }
        
        .skip-info {
            color: #6c757d;
            font-size: 0.9rem;
            margin: 10px 0;
            padding: 10px;
            background: rgba(108, 117, 125, 0.1);
            border-radius: 8px;
            border: 1px solid rgba(108, 117, 125, 0.3);
        }
    </style>
</head>
<body>
    <div class="widget-overlay" id="widgetOverlay"></div>
    
    <div class="success-widget" id="successWidget">
        <div class="widget-header">
            <div class="widget-title">ü§°ü§°ü§°</div>
            <div class="widget-subtitle">–ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨ –ù–ê–ñ–ê–õ –ö–ù–û–ü–ö–£ –ß–¢–û –ë–´ –í–°–ï –ó–ù–ê–õ–ò –ß–¢–û –û–ù –õ–ï–ô–ú.</div>
        </div>
        
        <div class="gif-container">
            <!-- –ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—É—é –≥–∏—Ñ–∫—É 518x518 -->
            <img src="img/–∞—Ö–∞—Ö—Ö–∞—Ö–∞.gif" 
                 alt="–ê—Ö–∞—Ö—Ö–∞—Ö–∞" 
                 class="success-gif"
                 onerror="this.onerror=null; this.src='https://media.giphy.com/media/xT0xeJpnrWC4XWblEk/giphy.gif'">
        </div>
        
        <div class="music-controls">
            <button class="music-btn" id="musicToggle">
                <span id="musicIcon">‚ñ∂Ô∏è</span>
            </button>
            <div class="music-info">
                <div class="music-title">–Ω–æ–ª—å –º—É–∂—Å–∫–æ–≥–æ gang</div>
                <div class="music-status" id="musicStatus">–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è</div>
            </div>
        </div>
        
        <div class="widget-footer">
            <button class="continue-btn" id="continueBtn">
                <span>üíî</span> –ü–†–û–°–¢–û 0 –ú–£–ñ–°–ö–û–ì–û.
            </button>
        </div>
    </div>
    
    <div class="captcha-container">
        <div class="header">
            <div class="step-indicator">
                <div class="step completed">1</div>
                <div class="step active">2</div>
                <div class="step">3</div>
            </div>
            <h1>–¢–ï–ü–ï–†–¨ –ß–ï</h1>
            <div class="instructions">
                –ê –¢–ï–ü–ï–†–¨ –ü–†–û–¶–ï–ù–¢ –°–†–ï–ó–ê–ù –ù–ê–•–£–ô –° 65 –î–û 92.
            </div>
        </div>
        
        <div class="target-range">
            <div class="target-title">–ù–£ –î–ê–í–ê–ô –ß–ò–¢–ê–ô –°–¢–†–û–ß–ö–£ –õ–Æ–ë–ò–ú–û–ì–û –ò–°–ü–û–õ–ù–ò–¢–ï–õ–Ø.</div>
            <div class="target-description">
                –ù–£–ñ–ù–û –ù–ê–ë–†–ê–¢–¨ –ê –Ø –£–ñ–ï –ü–ò–°–ê–õ –°–ö–û–õ–¨–ö–û 
                <span class="target-zone"> –ù–û –¢–´ –ù–ï –ó–ê–ë–´–í–ê–ô –ú–ò–ù–ò–ú–£–ú 92%</span> 
                <br>
                <small>–†–ï–ö–õ–ê–ú–£ –¢–ê–ö –ò –ù–ï –ó–ê–ö–£–ü–ò–õ–ò –ñ–î–ê–õ –ì–û–î.</small>
            </div>
        </div>
        
        <div class="phrase-container">
            <div class="phrase" id="phrase">–¢–æ —á—Ç–æ —è –ª–∏–∑–∞–ª —Ç–µ–±–µ –∑–∞–±—É–¥—å —è –±—ã–ª –ø–æ–¥ –∫–æ–¥–µ–∏–Ω–æ–º</div>
            <div class="phrase-hint">–ê –ü–û–•–£–ô –ú–ù–ï.</div>
            <div class="phrase-hint">–Ø –ó–ê–ï–ë–ê–õ–°–Ø –≠–¢–û –£–ñ–ï –î–ï–õ–ê–¢–¨.</div>
        </div>
        
        <div class="skip-info" id="skipInfo">
            ü§° –î–õ–Ø –ö–ê–ó–£–ê–õ–û–í –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∫–∞–ø—á—É
        </div>
        
        <div class="waiting-message" id="waitingMessage">
            ‚è≥ –ñ–ú–ê–ô –ù–ê–ß–ê–¢–¨
        </div>
        
        <div class="browser-warning" id="browserWarning">
            ‚ö†Ô∏è –î–ª—è —Ä–∞–±–æ—Ç—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º –±—Ä–∞—É–∑–µ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏ (Chrome, Edge).
            –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–∏–∫—Ä–æ—Ñ–æ–Ω –ø–æ–¥–∫–ª—é—á–µ–Ω –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω –¥–æ—Å—Ç—É–ø.
        </div>
        
        <div class="controls">
            <button class="control-btn record-btn" id="startBtn">
                <span>üé§</span> –ù–ê–ß–ê–¢–¨
            </button>
            <button class="control-btn stop-btn" id="stopBtn" disabled>
                <span>‚èπÔ∏è</span> –û–°–¢–ê–ù–û–í–ò–¢–¨
            </button>
            <button class="control-btn skip-btn" id="skipBtn">
                <span>‚è≠Ô∏è</span> –î–õ–Ø –õ–ï–ô–ú–û–í
            </button>
        </div>
        
        <div class="recording-status" id="recordingStatus">
            <div class="pulse-dot"></div>
            –ê –ó–ê–ü–ò–°–¨ –¢–û –ò–î–ï–¢.
        </div>
        
        <div class="result-container" id="resultContainer">
            <div class="result-header">
                <div class="result-icon" id="resultIcon">üéØ</div>
                <div class="result-text" id="resultText">–ê–ù–ê–õ–ò–ó –†–ï–ó–£–õ–¨–¢–ê–¢–ê</div>
            </div>
            
            <div class="recognized-text" id="recognizedText">
                –†–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å...
            </div>
            
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="progress-labels">
                    <div class="progress-label">–¢–û–ß–ù–û–°–¢–¨ –†–ê–°–ü–û–ó–ù–ê–í–ê–ù–ò–Ø</div>
                    <div class="progress-value" id="confidenceValue">0%</div>
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="action-btn retry-btn" onclick="retryRecording()">
                    <span>üîÑ</span> –ü–û–ü–†–û–ë–û–í–ê–¢–¨ –ï–©–ï –†–ê–ó
                </button>
            </div>
        </div>
    </div>

    <!-- –ê—É–¥–∏–æ –¥–ª—è –≤–∏–¥–∂–µ—Ç–∞ -->
    <audio id="successMusic" loop>
        <source src="music/–Ω–æ–ª—å –º—É–∂—Å–∫–æ–≥–æ.mp3" type="audio/mpeg">
        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç.
    </audio>

    <script>
        // ========== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ==========
        const CONFIG = {
            targetPhrase: '–¢–æ —á—Ç–æ —è –ª–∏–∑–∞–ª —Ç–µ–±–µ –∑–∞–±—É–¥—å —è –±—ã–ª –ø–æ–¥ –∫–æ–¥–µ–∏–Ω–æ–º',
            successThreshold: 92,
            highAccuracyThreshold: 95,
            recognitionConfig: {
                lang: 'ru-RU',
                continuous: true,
                interimResults: true,
                maxAlternatives: 5
            }
        };
        
        // ========== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ==========
        let SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        let recognition = null;
        let isRecording = false;
        let sessionId = Date.now();
        let currentScore = 0;
        let skipUsed = false;
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –≤–∏–¥–∂–µ—Ç–∞
        let isMusicPlaying = false;
        
        // ========== DOM –≠–õ–ï–ú–ï–ù–¢–´ ==========
        const elements = {
            // –û—Å–Ω–æ–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
            startBtn: document.getElementById('startBtn'),
            stopBtn: document.getElementById('stopBtn'),
            skipBtn: document.getElementById('skipBtn'),
            recordingStatus: document.getElementById('recordingStatus'),
            resultContainer: document.getElementById('resultContainer'),
            recognizedText: document.getElementById('recognizedText'),
            resultIcon: document.getElementById('resultIcon'),
            resultText: document.getElementById('resultText'),
            progressFill: document.getElementById('progressFill'),
            confidenceValue: document.getElementById('confidenceValue'),
            browserWarning: document.getElementById('browserWarning'),
            phrase: document.getElementById('phrase'),
            waitingMessage: document.getElementById('waitingMessage'),
            skipInfo: document.getElementById('skipInfo'),
            
            // –í–∏–¥–∂–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã
            widgetOverlay: document.getElementById('widgetOverlay'),
            successWidget: document.getElementById('successWidget'),
            musicToggle: document.getElementById('musicToggle'),
            musicIcon: document.getElementById('musicIcon'),
            musicStatus: document.getElementById('musicStatus'),
            continueBtn: document.getElementById('continueBtn'),
            successMusic: document.getElementById('successMusic')
        };
        
        // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ==========
        function init() {
            console.log(`[VoiceCaptcha ${sessionId}] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...`);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É –±—Ä–∞—É–∑–µ—Ä–∞
            const isSupported = checkBrowserSupport();
            
            if (isSupported) {
                initRecognition();
                elements.waitingMessage.style.display = 'block';
            }
            
            // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
            elements.startBtn.addEventListener('click', startRecording);
            elements.stopBtn.addEventListener('click', stopRecording);
            elements.skipBtn.addEventListener('click', skipCaptcha);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –≤–∏–¥–∂–µ—Ç–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–æ–ø—É—Å–∫–∞)
            elements.musicToggle.addEventListener('click', toggleMusic);
            elements.continueBtn.addEventListener('click', goToNextCaptcha);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–ø—É—Å–∫
            checkSkipAvailability();
            
            console.log(`[VoiceCaptcha ${sessionId}] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞`);
        }
        
        // ========== –í–ò–î–ñ–ï–¢ –î–õ–Ø –ü–†–û–ü–£–°–ö–ê ==========
        function showSkipWidget() {
            console.log(`[VoiceCaptcha ${sessionId}] –ü–æ–∫–∞–∑ –≤–∏–¥–∂–µ—Ç–∞ –¥–ª—è –ø—Ä–æ–ø—É—Å–∫–∞`);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–∏–¥–∂–µ—Ç –∏ –æ–≤–µ—Ä–ª–µ–π
            elements.widgetOverlay.classList.add('active');
            elements.successWidget.classList.add('active');
            
            // –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥–∏—Ñ–∫–∏ 518x518
            optimizeGifDisplay();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –º—É–∑—ã–∫—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
            setTimeout(() => {
                playMusic();
            }, 500);
        }
        
        function optimizeGifDisplay() {
            // –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ –≥–∏—Ñ–∫–∏
            const gif = document.querySelector('.success-gif');
            if (gif) {
                gif.onload = function() {
                    // –ï—Å–ª–∏ –≥–∏—Ñ–∫–∞ –∫–≤–∞–¥—Ä–∞—Ç–Ω–∞—è 518x518, –º–æ–∂–Ω–æ –Ω–µ–º–Ω–æ–≥–æ –ø–æ–¥–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                    if (gif.naturalWidth === 518 && gif.naturalHeight === 518) {
                        const container = document.querySelector('.gif-container');
                        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã—Å–æ—Ç—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ø–æ –≤—ã—Å–æ—Ç–µ –≥–∏—Ñ–∫–∏
                        container.style.height = '350px'; // –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è 518px
                    }
                };
            }
        }
        
        function playMusic() {
            if (!isMusicPlaying) {
                elements.successMusic.play()
                    .then(() => {
                        isMusicPlaying = true;
                        elements.musicIcon.textContent = '‚è∏Ô∏è';
                        elements.musicStatus.textContent = '–°–µ–π—á–∞—Å –∏–≥—Ä–∞–µ—Ç';
                        console.log(`[VoiceCaptcha ${sessionId}] –ú—É–∑—ã–∫–∞ –∑–∞–ø—É—â–µ–Ω–∞`);
                    })
                    .catch(error => {
                        console.error(`[VoiceCaptcha ${sessionId}] –û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è:`, error);
                        elements.musicStatus.textContent = '–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è';
                    });
            }
        }
        
        function toggleMusic() {
            if (isMusicPlaying) {
                elements.successMusic.pause();
                elements.musicIcon.textContent = '‚ñ∂Ô∏è';
                elements.musicStatus.textContent = '–ù–∞ –ø–∞—É–∑–µ';
                isMusicPlaying = false;
            } else {
                elements.successMusic.play()
                    .then(() => {
                        isMusicPlaying = true;
                        elements.musicIcon.textContent = '‚è∏Ô∏è';
                        elements.musicStatus.textContent = '–°–µ–π—á–∞—Å –∏–≥—Ä–∞–µ—Ç';
                    });
            }
        }
        
        // ========== –ü–ï–†–ï–•–û–î –ù–ê –°–õ–ï–î–£–Æ–©–£–Æ –ö–ê–ü–ß–£ ==========
        function goToNextCaptcha() {
            console.log(`[VoiceCaptcha ${sessionId}] –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é –∫–∞–ø—á—É...`);
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º—É–∑—ã–∫—É (–µ—Å–ª–∏ –∏–≥—Ä–∞–µ—Ç)
            elements.successMusic.pause();
            isMusicPlaying = false;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
            localStorage.setItem('captcha2Passed', 'true');
            localStorage.setItem('captcha2Score', currentScore);
            localStorage.setItem('captcha2Timestamp', new Date().toISOString());
            
            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –ø–æ–ø—ã—Ç–æ–∫
            const attempts = parseInt(localStorage.getItem('captchaAttempts') || '0');
            localStorage.setItem('captchaAttempts', (attempts + 1).toString());
            
            // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é –∫–∞–ø—á—É
            window.location.href = 'captcha3.html';
        }
        
        // ========== –ü–†–û–í–ï–†–ö–ê –î–û–°–¢–£–ü–ù–û–°–¢–ò –ü–†–û–ü–£–°–ö–ê ==========
        function checkSkipAvailability() {
            const captcha2Passed = localStorage.getItem('captcha2Passed');
            const attempts = parseInt(localStorage.getItem('captchaAttempts') || '0');
            
            if (captcha2Passed === 'true' || attempts > 0) {
                elements.skipBtn.disabled = false;
                elements.skipInfo.innerHTML = '‚ÄºÔ∏è <strong>–ú–û–ñ–ù–û –ü–†–û–ü–£–°–¢–ò–¨ –ï–°–õ–ò </strong> –ù–ò–ö–ê–ö–û–ì–û –£–í–ê–ñ–ï–ù–ò–Ø –ö–û –ú–ù–ï –ù–ï–¢. –£–ï–ë–û–ö';
            } else {
                elements.skipBtn.disabled = true;
                elements.skipInfo.innerHTML = '‚ÄºÔ∏è <strong>–ü—Ä–æ–ø—É—Å–∫ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω</strong> —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–∏';
            }
        }
        
        // ========== –§–£–ù–ö–¶–ò–Ø –ü–†–û–ü–£–°–ö–ê –ö–ê–ü–ß–ò ==========
        function skipCaptcha() {
            if (skipUsed) return;
            
            console.log(`[VoiceCaptcha ${sessionId}] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª –ü–†–û–ü–£–°–¢–ò–¢–¨`);
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–ø–∏—Å—å, –µ—Å–ª–∏ –æ–Ω–∞ –∏–¥–µ—Ç
            if (isRecording) {
                stopRecording();
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
            const confirmSkip = confirm('–ß–¢–û –£ –í–ê–° 0 –ú–£–ñ–°–ö–û–ì–û. \n\n–í–´ –°–¢–ê–ù–ò–¢–ï –õ–ï–ô–ú–û–ú –ò –ë–£–î–ï–¢–ï –ü–ï–†–ï–ù–ê–ü–†–í–õ–ï–ù–´ –ù–ê –ù–ï–ö–° –ö–ê–ü–ß–£.');
            
            
            
            if (!confirmSkip) return;
            
            skipUsed = true;
            
            // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫–∏
            elements.skipBtn.disabled = true;
            elements.skipBtn.innerHTML = '<span>ü§°</span> –ö–ê–ó–£–ê–õ';
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ–ø—É—Å–∫–µ
            localStorage.setItem('captcha2Passed', 'true');
            localStorage.setItem('captcha2Skipped', 'true');
            localStorage.setItem('captcha2SkipTimestamp', new Date().toISOString());
            
            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –ø–æ–ø—ã—Ç–æ–∫
            const attempts = parseInt(localStorage.getItem('captchaAttempts') || '0');
            localStorage.setItem('captchaAttempts', (attempts + 1).toString());
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–∏–¥–∂–µ—Ç —Å –≥–∏—Ñ–∫–æ–π
            showSkipWidget();
        }
        
        // ========== –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò –†–ê–°–ü–û–ó–ù–ê–í–ê–ù–ò–Ø ==========
        function checkBrowserSupport() {
            if (!SpeechRecognition) {
                elements.browserWarning.classList.add('show');
                elements.startBtn.disabled = true;
                elements.startBtn.innerHTML = '<span>üö´</span> –ù–ï –ü–û–î–î–ï–†–ñ–ò–í–ê–ï–¢–°–Ø';
                return false;
            }
            return true;
        }
        
        function initRecognition() {
            try {
                recognition = new SpeechRecognition();
                recognition.lang = CONFIG.recognitionConfig.lang;
                recognition.continuous = CONFIG.recognitionConfig.continuous;
                recognition.interimResults = CONFIG.recognitionConfig.interimResults;
                recognition.maxAlternatives = CONFIG.recognitionConfig.maxAlternatives;
                
                recognition.onstart = function() {
                    isRecording = true;
                    elements.recordingStatus.classList.add('active');
                    elements.startBtn.disabled = true;
                    elements.startBtn.classList.add('recording');
                    elements.stopBtn.disabled = false;
                    elements.waitingMessage.style.display = 'none';
                    console.log(`[VoiceCaptcha ${sessionId}] –ó–∞–ø–∏—Å—å –Ω–∞—á–∞—Ç–∞`);
                };
                
                recognition.onresult = function(event) {
                    const result = event.results[0];
                    let bestScore = 0;
                    let bestTranscript = '';
                    
                    for (let i = 0; i < result.length; i++) {
                        const alternative = result[i];
                        const transcript = alternative.transcript.toLowerCase().trim();
                        const confidence = alternative.confidence;
                        
                        const analysis = analyzeSimilarity(transcript, CONFIG.targetPhrase);
                        const confidencePercent = Math.round(confidence * 100);
                        const similarityPercent = Math.round(analysis.similarity * 100);
                        
                        const score = Math.round(
                            (confidencePercent * 0.4) + 
                            (similarityPercent * 0.6)
                        );
                        
                        if (score > bestScore) {
                            bestScore = score;
                            bestTranscript = transcript;
                        }
                    }
                    
                    console.log(`[VoiceCaptcha ${sessionId}] –õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: "${bestTranscript}" (–æ—Ü–µ–Ω–∫–∞: ${bestScore}%)`);
                    
                    processResult(bestTranscript, bestScore);
                };
                
                recognition.onerror = function(event) {
                    console.error(`[VoiceCaptcha ${sessionId}] –û—à–∏–±–∫–∞: ${event.error}`);
                    let errorMessage = '–û—à–∏–±–∫–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è';
                    switch (event.error) {
                        case 'no-speech':
                            errorMessage = '–†–µ—á—å –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≥–æ–≤–æ—Ä–∏—Ç—å –≥—Ä–æ–º—á–µ.';
                            break;
                        case 'audio-capture':
                            errorMessage = '–ú–∏–∫—Ä–æ—Ñ–æ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞.';
                            break;
                        case 'not-allowed':
                            errorMessage = '–î–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É –∑–∞–ø—Ä–µ—â–µ–Ω. –†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±—Ä–∞—É–∑–µ—Ä–∞.';
                            break;
                        default:
                            errorMessage = `–û—à–∏–±–∫–∞: ${event.error}`;
                    }
                    showError(errorMessage);
                    stopRecording();
                };
                
                recognition.onend = function() {
                    console.log(`[VoiceCaptcha ${sessionId}] –ó–∞–ø–∏—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∞`);
                    stopRecording();
                };
                
            } catch (error) {
                console.error(`[VoiceCaptcha ${sessionId}] –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:`, error);
                showError('–ù–µ —É–¥–∞–ª–æ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏');
            }
        }
        
        function analyzeSimilarity(recognized, target) {
            const normalizeText = (text) => {
                return text.toLowerCase()
                    .replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g, '')
                    .replace(/\s{2,}/g, ' ')
                    .trim();
            };
            
            const recognizedNormalized = normalizeText(recognized);
            const targetNormalized = normalizeText(target);
            
            if (recognizedNormalized === targetNormalized) {
                return { similarity: 1.0, matchedWords: targetNormalized.split(' ').length };
            }
            
            const recognizedWords = recognizedNormalized.split(/\s+/);
            const targetWords = targetNormalized.split(/\s+/);
            
            let totalScore = 0;
            let matchedWords = 0;
            
            targetWords.forEach((targetWord, targetIndex) => {
                let bestScore = 0;
                
                recognizedWords.forEach((recognizedWord, recIndex) => {
                    let score = 0;
                    
                    if (recognizedWord === targetWord) {
                        score = 1.0;
                    }
                    else if (recognizedWord.includes(targetWord) || targetWord.includes(recognizedWord)) {
                        const minLen = Math.min(recognizedWord.length, targetWord.length);
                        const maxLen = Math.max(recognizedWord.length, targetWord.length);
                        score = 0.9 * (minLen / maxLen);
                    }
                    else if (recognizedWord.slice(0, 3) === targetWord.slice(0, 3)) {
                        score = 0.7;
                    }
                    else if (recognizedWord.slice(0, 2) === targetWord.slice(0, 2)) {
                        score = 0.5;
                    }
                    else if (recognizedWord[0] === targetWord[0]) {
                        score = 0.3;
                    }
                    
                    if (score > 0 && targetIndex === recIndex) {
                        score = Math.min(1.0, score + 0.2);
                    }
                    
                    if (score > bestScore) {
                        bestScore = score;
                    }
                });
                
                totalScore += bestScore;
                
                if (bestScore >= 0.7) {
                    matchedWords++;
                }
            });
            
            const baseSimilarity = totalScore / targetWords.length;
            const wordMatchRatio = matchedWords / targetWords.length;
            
            const finalSimilarity = (baseSimilarity * 0.7) + (wordMatchRatio * 0.3);
            
            return {
                similarity: Math.min(1.0, finalSimilarity),
                matchedWords: matchedWords,
                totalWords: targetWords.length
            };
        }
        
        function startRecording() {
            if (!recognition || isRecording) return;
            
            console.log(`[VoiceCaptcha ${sessionId}] –ó–∞–ø—É—Å–∫ –∑–∞–ø–∏—Å–∏...`);
            resetResults();
            
            try {
                recognition.start();
            } catch (error) {
                console.error(`[VoiceCaptcha ${sessionId}] –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞:`, error);
                showError('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–ø–∏—Å—å. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');
            }
        }
        
        function stopRecording() {
            if (recognition && isRecording) {
                try {
                    recognition.stop();
                } catch (e) {}
            }
            
            isRecording = false;
            elements.recordingStatus.classList.remove('active');
            elements.startBtn.disabled = false;
            elements.startBtn.classList.remove('recording');
            elements.stopBtn.disabled = true;
        }
        
        function processResult(transcript, score) {
            currentScore = score;
            
            elements.resultContainer.classList.add('show');
            elements.recognizedText.textContent = `"${transcript}"`;
            
            elements.progressFill.style.width = score + '%';
            elements.confidenceValue.textContent = score + '%';
            
            console.log(`[VoiceCaptcha ${sessionId}] –ê–Ω–∞–ª–∏–∑:
                –û—Ü–µ–Ω–∫–∞: ${score}%
                –ü–æ—Ä–æ–≥ —É—Å–ø–µ—Ö–∞: ${CONFIG.successThreshold}%`);
            
            if (score >= CONFIG.successThreshold) {
                // –£–°–ü–ï–®–ù–û–ï –ü–†–û–•–û–ñ–î–ï–ù–ò–ï –ß–ï–†–ï–ó –ú–ò–ö–†–û–§–û–ù - –°–†–ê–ó–£ –ü–ï–†–ï–•–û–î!
                handleSuccess(transcript, score);
            } else {
                handleFailure(transcript, score);
            }
        }
        
        function handleSuccess(transcript, score) {
            console.log(`[VoiceCaptcha ${sessionId}] –£–°–ü–ï–•! –û—Ü–µ–Ω–∫–∞: ${score}% - –ù–ï–ú–ï–î–õ–ï–ù–ù–´–ô –ü–ï–†–ï–•–û–î`);
            
            if (score >= CONFIG.highAccuracyThreshold) {
                elements.resultIcon.textContent = 'üéØ';
                elements.resultIcon.style.color = '#00cec9';
                elements.resultText.textContent = `–í–´–°–û–ö–ê–Ø –¢–û–ß–ù–û–°–¢–¨ (${score}%)`;
                elements.resultText.className = 'result-text high-accuracy';
                elements.resultContainer.classList.add('high-accuracy-animation');
            } else {
                elements.resultIcon.textContent = '‚úÖ';
                elements.resultIcon.style.color = '#00b894';
                elements.resultText.textContent = `–£–°–ü–ï–®–ù–û (${score}%)`;
                elements.resultText.className = 'result-text success';
                elements.resultContainer.classList.add('success-animation');
            }
            
            // –°–†–ê–ó–£ –°–û–•–†–ê–ù–Ø–ï–ú –î–ê–ù–ù–´–ï –ò –ü–ï–†–ï–•–û–î–ò–ú
            setTimeout(() => {
                goToNextCaptcha();
            }, 1500); // –ó–∞–¥–µ—Ä–∂–∫–∞ 1.5 —Å–µ–∫—É–Ω–¥—ã –¥–ª—è –ø–æ–∫–∞–∑–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
        }
        
        function handleFailure(transcript, score) {
            console.log(`[VoiceCaptcha ${sessionId}] –ù–ï–£–î–ê–ß–ê –û—Ü–µ–Ω–∫–∞: ${score}%`);
            
            elements.resultIcon.textContent = '‚ùå';
            elements.resultIcon.style.color = '#fdcb6e';
            elements.resultText.textContent = `–ù–£–ñ–ù–û –õ–£–ß–®–ï (${score}%)`;
            elements.resultText.className = 'result-text error';
            elements.resultContainer.classList.remove('success-animation', 'high-accuracy-animation');
            
            const needed = CONFIG.successThreshold - score;
            elements.recognizedText.innerHTML = `
                "${transcript}"<br>
                <small style="color: #fdcb6e;">
                    –ì–û–í–û–†–ò –©–ê  ${needed}% –ê –ù–ê–î–û ${CONFIG.successThreshold}%<br>
                    –ê–•–ê–•–ê–•
                </small>
            `;
        }
        
        function resetResults() {
            elements.resultContainer.classList.remove('show');
            elements.progressFill.style.width = '0%';
            elements.confidenceValue.textContent = '0%';
            elements.resultContainer.classList.remove('success-animation', 'high-accuracy-animation');
            elements.waitingMessage.style.display = 'none';
            elements.startBtn.disabled = false;
            currentScore = 0;
        }
        
        function showError(message) {
            elements.resultContainer.classList.add('show');
            elements.resultIcon.textContent = '‚ö†Ô∏è';
            elements.resultIcon.style.color = '#fdcb6e';
            elements.resultText.textContent = message;
            elements.resultText.className = 'result-text error';
            elements.recognizedText.textContent = '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö';
            elements.progressFill.style.width = '0%';
            elements.confidenceValue.textContent = '0%';
        }
        
        function retryRecording() {
            console.log(`[VoiceCaptcha ${sessionId}] –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞`);
            resetResults();
        }
        
        // ========== –ó–ê–ü–£–°–ö ==========
        document.addEventListener('DOMContentLoaded', init);
        
        // –≠–∫—Å–ø–æ—Ä—Ç —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –∫–Ω–æ–ø–æ–∫
        window.retryRecording = retryRecording;
        window.skipCaptcha = skipCaptcha;
    </script>
</body>
</html>